SELECT HL7SegmentDataElements.seg_code AS seg_code, count(HL7SegmentDataElements.seg_code) AS total_fields, HL7DataElements.version_id AS version_id INTO GeneratedFieldCounts FROM HL7DataStructures INNER JOIN (HL7DataElements INNER JOIN HL7SegmentDataElements ON (HL7DataElements.data_item = HL7SegmentDataElements.data_item) AND (HL7DataElements.version_id = HL7SegmentDataElements.version_id)) ON (HL7DataStructures.data_structure = HL7DataElements.data_structure) AND (HL7DataStructures.version_id = HL7DataElements.version_id) GROUP BY HL7SegmentDataElements.seg_code, HL7DataElements.version_id ORDER BY HL7SegmentDataElements.seg_code, HL7DataElements.version_id